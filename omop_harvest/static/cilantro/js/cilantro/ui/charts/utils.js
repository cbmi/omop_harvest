define(["underscore","highcharts"],function(t,e){var i=function(t){var i=e.getOptions().colors;return i[t%i.length]},n=function(t){var e=parseInt(t.substr(0,4)),i=parseInt(t.substr(5,2))-1,n=parseInt(t.substr(8,2));return Date.UTC(e,i,n)},s=function(t,s,o){if(s.length>2)throw new Error("3-dimensional charts are not supported.Specify which field the series applies to.");if(!s)throw new Error("The field instances must be supplied");var r,a,l,h,c,u,d,p=[],f=[],g=s[0],v=s[1];r=g.get("name"),a=g.get("enumerable")||"boolean"===g.get("simple_type"),l="date"===g.get("simple_type")?"datetime":"linear",v?(h=v.get("name"),c=v.get("enumerable")||"boolean"===v.get("simple_type"),u="date"===v.get("simple_type")?"datetime":"linear"):(h="Frequency",c=!1,u="linear"),a&&c?(d="scatter",p.push(" "),f.push(" ")):d=!v||a||c?c?"scatter":"column":"scatter";for(var m,y,b,w={},x=t.clustered,C=t.data,_=0;_<C.length;_++){m=C[_],y=o?m.values.slice(o,o+1)[0]:"",(b=w[y])?(b.data.push(m),b.stats.min=Math.min(b.stats.min,m.count),b.stats.max=Math.max(b.stats.max,m.count),b.stats.sum+=m.count):(b=w[y]={name:y,stats:{min:m.count,max:m.count,sum:m.count}},b.data=a&&c?[{x:0,y:0,radius:0,sentinel:!0},m]:[m]);var k=m.values[0];null===k&&(k="(no data)"),a?-1===p.indexOf(k.toString())&&(k=p.push(k.toString())-1):"datetime"===l&&(k=n(k));var $;v?($=m.values[1],null===$&&($="(no data)"),c?-1===f.indexOf($.toString())&&($=f.push($.toString())-1):"datetime"===u&&($=n($))):$=m.count,m.x=k,m.y=$}var E,S,T=[];a&&c&&(E=p.push(" ")-1,S=f.push(" ")-1);var A=0;for(var O in w){b=w[O],a&&c&&(b.data.push({x:0,y:S,radius:0,sentinel:!0}),b.data.push({x:E,y:S,radius:0,sentinel:!0}),b.data.push({x:E,y:S,radius:0,sentinel:!0})),T.push(b);var P=b.stats.avg=b.stats.sum/parseFloat(b.data.length,10);if("scatter"===d)for(var _=0;_<b.data.length;_++){var N=b.data[_];if(!N.sentinel){var j=Math.min(Math.max(parseInt(5*(parseFloat(N.count,10)/P))/10,.05),1),I=e.Color(i(A)).setOpacity(j);N.marker={fillColor:I.get()},a&&(N.marker.radius=7)}}A++}var D;D="scatter"===d&&a?T[1]?function(){return"<h5>"+this.series.name+"</h5><br /><b>"+r+":</b>"+this.series.xAxis.categories[this.point.x]+"<br /><b>"+h+":</b>"+this.series.yAxis.categories[this.point.y]}:function(){return"<b>"+r+":</b>"+this.series.xAxis.categories[this.point.x]+"<br /><b>"+h+":</b>"+this.series.yAxis.categories[this.point.y]}:"column"===d&&a?T[1]?function(){return"<h5>"+this.series.name+"</h5><br /><b>"+r+":</b>"+this.series.xAxis.categories[this.point.x]+"<br /><b>"+h+":</b>"+e.numberFormat(parseFloat(this.y))}:function(){return"<b>"+r+":</b>"+this.series.xAxis.categories[this.point.x]+"<br /><b>"+h+":</b>"+e.numberFormat(parseFloat(this.y))}:T[1]?function(){return"<h5>"+this.series.name+"</h5><br /><b>"+r+":</b>"+e.numberFormat(parseFloat(this.x))+"<br /><b>"+h+":</b>"+e.numberFormat(parseFloat(this.y))}:function(){return"<b>"+r+":</b>"+e.numberFormat(parseFloat(this.x))+"<br /><b>"+h+":</b>"+e.numberFormat(parseFloat(this.y))};var q={clustered:x,chart:{type:d},title:{text:v?""+r+" vs. "+h:""+r+" "+h},series:T,xAxis:{title:{text:r},type:l},yAxis:{title:{text:h},type:u},tooltip:{formatter:D}};return p.length&&(q.xAxis.categories=p),f.length&&(q.yAxis.categories=f),T[1]||(q.legend={enabled:!1}),"scatter"===d&&(q.yAxis.gridLineWidth=0,a||(q.chart.zoomType="xy")),q},o=function(e){for(var i,n,s=[],o=0;o<e.length;o++)n=e[o],i=t.clone(n),i.x=n.values[0],i.y=null!==n.values[1]?n.values[1]:n.count,s.push(i);return{data:t.sortBy(s,"x")}};return{processResponse:s,getSeries:o}});
//@ sourceMappingURL=utils.js.map