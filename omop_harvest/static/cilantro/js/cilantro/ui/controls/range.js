define(["underscore","./base","../button","../../constants"],function(e,t,i,n){var s=t.Control.extend({template:"controls/range/layout",events:{"keyup .range-lower, .range-upper":"_change","change .btn-select":"_change","click .range-help-button":"toggleHelpText"},ui:{operatorSelect:".btn-select",lowerBound:".range-lower",upperBound:".range-upper",help:".help-block"},initialize:function(){this._change=e.debounce(this.change,n.INPUT_DELAY)},onRender:function(){this.operatorSelect=new i.ButtonSelect({collection:[{value:"range",label:"between",selected:!0},{value:"-range",label:"not between"}]}),this.operatorSelect.render().$el.prependTo(this.$el),this.ui.help.hide(),this.renderBounds(),this.listenTo(this.model.stats,"reset",this.renderBounds)},renderBounds:function(){this.readMinMaxStats(),e.isUndefined(this.minLowerBound)||this.setLowerBoundPlaceholder(this.minLowerBound),e.isUndefined(this.maxUpperBound)||this.setUpperBoundPlaceholder(this.maxUpperBound)},parseMinStat:function(e){return e},parseMaxStat:function(e){return e},readMinMaxStats:function(){var t=this.model.stats.get("min"),i=this.model.stats.get("max");e.isUndefined(t)||(this.minLowerBound=this.parseMinStat(t.get("value"))),e.isUndefined(i)||(this.maxUpperBound=this.parseMaxStat(i.get("value")))},toggleHelpText:function(e){e.preventDefault(),this.ui.help.toggle()},getField:function(){return this.model.id},getOperator:function(){var e=this.ui.lowerBound.val(),t=this.ui.upperBound.val(),i=this.operatorSelect.getSelection(),n="range"!==i;return i=""!==e&&""!==t?i:""!==e?n?"lte":"gte":""!==t?n?"gte":"lte":void 0},getLowerBoundValue:function(){return this.ui.lowerBound.val()},getUpperBoundValue:function(){return this.ui.upperBound.val()},exists:function(t){return e.exists(t)&&""!==t},getValue:function(){var e,t=this.getLowerBoundValue(),i=this.getUpperBoundValue();return this.exists(t)&&this.exists(i)?e=[t,i]:this.exists(t)?e=t:this.exists(i)&&(e=i),e},isFocused:function(e){return document.activeElement===e},setOperator:function(e){"-range"!==e&&(e="range"),this.operatorSelect.setSelection(e)},setLowerBoundPlaceholder:function(e){this.ui.lowerBound.prop("placeholder",e)},setLowerBoundValue:function(e){this.isFocused(this.ui.lowerBound[0])||this.ui.lowerBound.val(e)},setUpperBoundPlaceholder:function(e){this.ui.upperBound.prop("placeholder",e)},setUpperBoundValue:function(e){this.isFocused(this.ui.upperBound[0])||this.ui.upperBound.val(e)},set:function(t){if(!this._changing){this.setOperator(t.operator),this.setUpperBoundValue(),this.setLowerBoundValue();var i=t.value;e.isArray(i)?(e.isUndefined(i[0])||this.setLowerBoundValue(i[0]),e.isUndefined(i[1])||this.setUpperBoundValue(i[1])):e.isUndefined(i)||("gte"===t.operator?this.setLowerBoundValue(i):this.setUpperBoundValue(i))}},validate:function(t){return e.isUndefined(t.value)||e.isNull(t.value)?"A lower or upper value must be defined":e.isArray(t.value)&&t.value[0]>t.value[1]?"The lower bound cannot be greater than the upper":void 0}});return{RangeControl:s}});
//@ sourceMappingURL=range.js.map