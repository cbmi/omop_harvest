define(["underscore","backbone","marionette","jquery","loglevel","./core","./ui"],function(t,e,i,n,s,o,r){function a(t){t=t||window.event;var e;e=t.type in d?d[t.type]:!this[c],e===!0?o.trigger("visible"):e===!1&&o.trigger("hidden")}o.templates.set(o.config.get("templates",{})),o.controls.set(o.config.get("controls",{}));var h=i.TemplateCache.prototype.loadTemplate,l=i.TemplateCache.prototype.compileTemplate;i.TemplateCache.prototype.loadTemplate=function(t){var e=o.templates.get(t);return e||(e=h.call(this,t)),e},i.TemplateCache.prototype.compileTemplate=function(t){return"function"!=typeof t&&(t=l(t)),t},t.exists=function(e){return!t.isUndefined(e)&&!t.isNull(e)};var u=new r.Notifications({id:"cilantro-notifications"});n("body").append(u.render().el),o.notify=u.notify,n.ajaxPrefilter(function(t){t.xhrFields={withCredentials:!0}}),o.config.get("debug")&&(s.setLevel("debug"),o.on("all",function(){s.info.apply(s.info,[].slice.call(arguments,0))})),n(window).on("beforeunload",function(){return o.config.get("debug")||!n.hasPendingRequest()?(n(document).off("ajaxError"),void 0):"Wow, you're quick! Your data is being saved. It will only take a moment."}),n(document).ajaxError(function(t,e,i,n){if(!("abort"===e.statusText||e.status>=300&&e.status<400)){var s="";s=0===e.status&&""===n?"The application is no longer responding.":'There is a communication problem with the server. <a href="#" onclick="location.reload()">Refreshing</a> the page may help.',o.notify({timeout:null,dismissable:!0,level:"error",header:"Uh oh.",message:s})}}),n(document).on("click","a",function(t){if(o.router){var i=this.pathname;"/"!==i.charAt(0)&&(i="/"+i);var n=e.history.root||"/";i.slice(0,n.length)===n&&(i=i.slice(n.length)),o.router.hasRoute(i)&&(t.preventDefault(),o.router.navigate(i,{trigger:!0}))}}),n(document).on("click","[data-route]",function(t){if(o.router){var e=n(t.target).attr("data-route");o.router.isNavigable(e)&&(t.preventDefault(),o.router.navigate(e,{trigger:!0}))}});var c="hidden",d={focus:!0,focusin:!0,pageshow:!0,blur:!1,focusout:!1,pagehide:!1};c in document?document.addEventListener("visibilitychange",a):(c="mozHidden")in document?document.addEventListener("mozvisibilitychange",a):(c="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",a):(c="msHidden")in document?document.addEventListener("msvisibilitychange",a):"onfocusin"in document?document.onfocusin=document.onfocusout=a:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=a});
//@ sourceMappingURL=setup.js.map